<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content">
    <script>
    // Lógica de Proteção de Rota
    const token = localStorage.getItem('token');
    if (!token) {
        window.location.href = 'login.html';
    }
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitrine | Facility.IA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <link rel="stylesheet" href="styles.css">

    <style>
        * { box-sizing: border-box; }
        body { margin: 0; background: #050507; font-family: 'Segoe UI', sans-serif; overflow-x: hidden; }

        .layout { display: flex; min-height: 100vh; }

        /* Sidebar Ajustada */
        .sidebar {
            width: 250px; background: rgba(10, 10, 12, 0.95);
            border-right: 1px solid rgba(255,255,255,0.05);
            padding: 30px; display: flex; flex-direction: column;
            position: fixed; height: 100vh; z-index: 100; transition: transform 0.3s;
        }
        .logo { font-size: 1.2rem; color: white; margin-bottom: 40px; font-weight: bold; letter-spacing: 1px; }
        .logo span { color: #00ff88; }
        
        .nav-btn {
            display: flex; align-items: center; gap: 15px; padding: 12px 0;
            color: #888; text-decoration: none; font-size: 0.95rem; transition: 0.3s; cursor: pointer;
        }
        .nav-btn:hover, .nav-btn.active { color: white; }
        .nav-btn.active { border-right: 3px solid #00ff88; }
        
        .nav-btn i { width: 20px; text-align: center; }

        /* Espaçador Flexível */
        .spacer { flex: 1; } 

        .btn-logout {
            display: flex; align-items: center; gap: 15px; padding: 12px 0;
            color: #ff5555; text-decoration: none; font-size: 0.95rem; transition: 0.3s; cursor: pointer;
            border-top: 1px solid rgba(255,255,255,0.05); margin-top: 10px;
        }
        .btn-logout:hover { color: #ff8888; padding-left: 5px; }

        .user-mini { 
            margin-top: 15px; display: flex; align-items: center; gap: 10px; 
            padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); 
            cursor: pointer; transition: 0.3s; text-decoration: none;
        }
        .user-mini:hover { opacity: 0.8; }
        .avatar { 
            width: 35px; height: 35px; 
            background: linear-gradient(135deg, var(--primary) 0%, #009966 100%); 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            color: black; font-weight: bold; font-size: 0.9rem; text-transform: uppercase;
            background-size: cover; background-position: center;
        }

        /* Content */
        .content { margin-left: 250px; padding: 40px; width: 100%; position: relative; z-index: 1; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        
        /* Hero */
        .hero-banner {
            background: linear-gradient(135deg, rgba(22, 27, 34, 0.9) 0%, rgba(5, 5, 7, 0.9) 100%), url('https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1200&auto=format&fit=crop');
            background-size: cover; background-position: center; border-radius: 20px; padding: 40px;
            border: 1px solid rgba(255,255,255,0.1); margin-bottom: 40px; position: relative; overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .hero-content { position: relative; z-index: 2; max-width: 500px; }
        .hero-title { font-size: 2rem; color: white; margin: 0 0 10px 0; }
        .hero-desc { color: #aaa; margin-bottom: 25px; line-height: 1.5; }
        .hero-btn { background: #00ff88; color: black; border: none; padding: 12px 30px; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.3s; text-decoration: none; display: inline-block; }
        .hero-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(0,255,136,0.4); }

        /* Categorias */
        .category-tabs { display: flex; gap: 15px; margin-bottom: 25px; overflow-x: auto; padding-bottom: 5px; }
        .cat-tab { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.05); padding: 8px 20px; border-radius: 20px; color: #ccc; cursor: pointer; white-space: nowrap; transition: 0.3s; }
        .cat-tab.active, .cat-tab:hover { background: white; color: black; border-color: white; }

        /* Grid */
        .section-title { font-size: 1.1rem; color: white; margin-bottom: 20px; font-weight: 600; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .app-card { background: rgba(22, 27, 34, 0.6); border: 1px solid rgba(255,255,255,0.05); border-radius: 15px; padding: 20px; transition: 0.3s; cursor: pointer; display: flex; flex-direction: column; height: 100%; position: relative; text-decoration: none; }
        .app-card.hidden { display: none; }
        .app-card:hover { transform: translateY(-5px); background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.2); }
        .card-icon { width: 40px; height: 40px; border-radius: 10px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; background: rgba(0,0,0,0.3); }
        .card-title { color: white; font-weight: bold; margin-bottom: 5px; font-size: 0.95rem; }
        .card-desc { color: #888; font-size: 0.8rem; line-height: 1.4; flex: 1; }
        .card-arrow { align-self: flex-end; color: #00ff88; font-size: 0.8rem; margin-top: 10px; opacity: 0; transition: 0.3s; }
        .app-card:hover .card-arrow { opacity: 1; transform: translateX(5px); }

        .icon-blue { color: #00ccff; } .icon-purple { color: #bd93f9; } .icon-pink { color: #ff0055; } .icon-green { color: #00ff88; } .icon-yellow { color: #ffcc00; }

        @media (max-width: 900px) {
            .sidebar { transform: translateX(-100%); width: 100%; }
            .sidebar.active { transform: translateX(0); }
            .content { margin-left: 0; padding: 20px; padding-top: 60px; }
        }
    </style>
</head>
<body>

    <div id="particles-js" style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:0;"></div>
    
    <div class="layout">
        <nav class="sidebar" id="sidebar">
            <div class="logo">FACILITY<span>.IA</span></div>
            
            <a href="dashboard.html" class="nav-btn active"><i class="fas fa-th-large"></i> Início</a>
            <a href="chatcomIA.html" class="nav-btn"><i class="fas fa-bolt"></i> Assistentes</a>
            
            <a href="meus_prompts.html" class="nav-btn"><i class="fas fa-terminal"></i> Meus Prompts</a>
            <a href="prompts.html" class="nav-btn"><i class="fas fa-lightbulb"></i> Aprenda Prompts</a>
            
            <a href="planos.html" class="nav-btn"><i class="fas fa-layer-group"></i> Planos</a>
            <a href="configuracoes.html" class="nav-btn"><i class="fas fa-cog"></i> Configurações</a>

            <div id="adminArea" style="display: none; flex-direction: column; border-top: 1px solid rgba(255,255,255,0.1); margin-top: 10px; padding-top: 10px;">
                <div style="font-size: 0.7rem; color: #666; margin-bottom: 5px; padding-left: 5px; text-transform: uppercase;">Administração</div>
                
                <a href="treinamento.html" class="nav-btn" style="color: #00F3FF;">
                    <i class="fas fa-brain"></i> Treinamento
                </a>
                <a href="admin.html" class="nav-btn" style="color: #ffcc00;">
                    <i class="fas fa-lock"></i> Painel Admin
                </a>
            </div>
            <div class="spacer"></div>

            <a href="#" onclick="fazerLogout()" class="btn-logout">
                <i class="fas fa-sign-out-alt"></i> Sair
            </a>

            <a href="perfil.html" class="user-mini">
                <div class="avatar" id="sidebarAvatar">?</div>
                <div style="font-size:0.8rem; color:#ccc;">
                    <div id="sidebarUserName">Usuário</div>
                    <div style="color:#666; font-size:0.7rem;">Ver Perfil</div>
                </div>
            </a>
        </nav>
<div class="card-plan-status" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; color: white; margin-bottom: 20px;">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3 style="margin:0; font-size:1rem; color:#888;">SEU PLANO</h3>
        <span id="planBadge" style="background:#00ff88; color:black; padding:4px 12px; border-radius:12px; font-weight:bold; font-size:0.8rem;">CARREGANDO...</span>
    </div>
    
    <div style="margin-top:15px;">
        <h2 id="planName" style="margin:0; font-size:1.8rem;">...</h2>
        <p id="planCycle" style="color:#aaa; margin:5px 0 0 0; font-size:0.9rem;">Ciclo ...</p>
    </div>

    <div style="margin-top:20px; border-top:1px solid rgba(255,255,255,0.1); padding-top:15px;">
        <a href="planos.html" style="color:#00ff88; text-decoration:none; font-size:0.9rem; font-weight:bold;">
            <i class="fas fa-arrow-up"></i> Fazer Upgrade
        </a>
    </div>
</div>
        <main class="content">
            <div class="top-bar">
                <div style="color:#888;">Bem-vindo de volta ao seu Workspace.</div>
            </div>

            <div class="hero-banner">
                <div class="hero-content">
                    <h2 class="hero-title">Automatize sua rotina.</h2>
                    <p class="hero-desc">Precisa de algo rápido e sem filtros? Use nossa IA pura para tarefas gerais.</p>
                    <a href="chatcomIA.html?agent=ia_pura" class="hero-btn">
                        <i class="fas fa-sparkles"></i> Chat Genérico (IA)
                    </a>
                </div>
            </div>

            <div class="category-tabs">
                <div class="cat-tab active" onclick="filterApps('all', this)">Todos</div>
                <div class="cat-tab" onclick="filterApps('tech', this)">T.I. & Dev</div>
                <div class="cat-tab" onclick="filterApps('trabalho', this)">Negócios</div>
                <div class="cat-tab" onclick="filterApps('estudo', this)">Educação</div>
                <div class="cat-tab" onclick="filterApps('criativo', this)">Criatividade</div>
            </div>

            <div class="section-title">Catálogo de Ferramentas</div>
            <div class="card-grid" id="appsGrid">
                <a href="chatcomIA.html?agent=juridico" class="app-card" data-category="trabalho">
                    <div class="card-icon icon-purple"><i class="fas fa-file-contract"></i></div>
                    <div class="card-title">Revisor de Contratos</div>
                    <div class="card-desc">Análise de riscos e cláusulas abusivas segundo a lei.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=dev_debugger" class="app-card" data-category="tech">
                    <div class="card-icon icon-blue"><i class="fas fa-bug"></i></div>
                    <div class="card-title">Code Debugger</div>
                    <div class="card-desc">Cole seu código (C#, JS, Python) e encontre o erro.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=marketing" class="app-card" data-category="criativo">
                    <div class="card-icon icon-pink"><i class="fas fa-hashtag"></i></div>
                    <div class="card-title">Social Media Pro</div>
                    <div class="card-desc">Gere legendas, roteiros de Reels e ideias virais.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=professor" class="app-card" data-category="estudo">
                    <div class="card-icon icon-green"><i class="fas fa-book-open"></i></div>
                    <div class="card-title">Resumo Acadêmico</div>
                    <div class="card-desc">Sintetize PDFs complexos em tópicos simples.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=redator_email" class="app-card" data-category="trabalho">
                    <div class="card-icon icon-purple"><i class="fas fa-envelope"></i></div>
                    <div class="card-title">E-mail Executivo</div>
                    <div class="card-desc">Escreva e-mails formais, diretos e persuasivos.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=dba" class="app-card" data-category="tech">
                    <div class="card-icon icon-blue"><i class="fas fa-database"></i></div>
                    <div class="card-title">Gerador de SQL</div>
                    <div class="card-desc">Descreva o que precisa e receba a query pronta.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=excel_pro" class="app-card" data-category="trabalho">
                    <div class="card-icon icon-green"><i class="fas fa-table"></i></div>
                    <div class="card-title">Mestre do Excel</div>
                    <div class="card-desc">Crie fórmulas complexas e macros VBA.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="chatcomIA.html?agent=tutor_ingles" class="app-card" data-category="estudo">
                    <div class="card-icon icon-yellow"><i class="fas fa-language"></i></div>
                    <div class="card-title">Tutor de Inglês</div>
                    <div class="card-desc">Pratique conversação ou corrija sua gramática.</div>
                    <div class="card-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
            </div>
        </main>
    </div>
<script src="config.js"></script> <script src="script.js"></script>
    <script>
        if(typeof particlesJS !== 'undefined') {
            particlesJS("particles-js", {
                "particles": { "number": { "value": 30 }, "color": { "value": "#ffffff" }, "opacity": { "value": 0.1 }, "size": { "value": 2 }, "move": { "enable": true, "speed": 0.5 } },
                "interactivity": { "events": { "onhover": { "enable": false } } }
            });
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }

        function filterApps(category, btnElement) {
            const buttons = document.querySelectorAll('.cat-tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            btnElement.classList.add('active');
            const cards = document.querySelectorAll('.app-card[data-category]');
            cards.forEach(card => {
                const cardCat = card.getAttribute('data-category');
                if (category === 'all' || cardCat === category) {
                    card.classList.remove('hidden');
                    card.style.opacity = '0';
                    setTimeout(() => card.style.opacity = '1', 50);
                } else {
                    card.classList.add('hidden');
                }
            });
        }

        function checkAdminRole() {
            const token = localStorage.getItem('token');
            if (!token) return;
            try {
                const payload = JSON.parse(atob(token.split('.')[1]));
                // Tenta pegar a role de várias formas possíveis (padrão JWT .NET)
                const userRole = payload["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"] || payload["role"];
                
                // Se for ADMIN, desbloqueia a área restrita
                if (userRole === 'admin') {
                    document.getElementById('adminArea').style.display = 'flex';
                }
            } catch (e) { console.error(e); }
        }

        function fazerLogout() {
            localStorage.removeItem('token');
            localStorage.removeItem('userData');
            window.location.href = 'index.html';
        }

        function loadUserData() {
            try {
                const userDataStr = localStorage.getItem('userData');
                let initial = "U";
                let userEmail = "";

                if(userDataStr) {
                    const user = JSON.parse(userDataStr);
                    const name = user.name || user.Name || "Usuário";
                    userEmail = user.email || user.Email || "";
                    document.getElementById('sidebarUserName').innerText = name;
                    initial = name.charAt(0).toUpperCase();
                }
                const savedPhoto = localStorage.getItem(`userPhoto_${userEmail}`);
                const avatarEl = document.getElementById('sidebarAvatar');

                if (savedPhoto) {
                    avatarEl.innerText = "";
                    avatarEl.style.backgroundImage = `url('${savedPhoto}')`;
                } else {
                    avatarEl.style.backgroundImage = "none";
                    avatarEl.innerText = initial;
                }
            } catch (e) {
                console.error("Erro", e);
            }
        }

        checkAdminRole();
        loadUserData();
    </script>
</body>
</html>